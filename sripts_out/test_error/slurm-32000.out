[2024-04-23 16:51:26,878] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/share/home/22351111/anaconda3/envs/llama_peft4/lib/python3.9/site-packages/transformers/deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
Traceback (most recent call last):
  File "/share/home/22351111/lyc_LoRA_Test/src/train_bash.py", line 1, in <module>
    from llmtuner import run_exp
  File "/share/home/22351111/lyc_LoRA_Test/src/llmtuner/__init__.py", line 3, in <module>
    from llmtuner.api import create_app
  File "/share/home/22351111/lyc_LoRA_Test/src/llmtuner/api/__init__.py", line 1, in <module>
    from llmtuner.api.app import create_app
  File "/share/home/22351111/lyc_LoRA_Test/src/llmtuner/api/app.py", line 9, in <module>
    from llmtuner.chat import ChatModel
  File "/share/home/22351111/lyc_LoRA_Test/src/llmtuner/chat/__init__.py", line 1, in <module>
    from llmtuner.chat.stream_chat import ChatModel
  File "/share/home/22351111/lyc_LoRA_Test/src/llmtuner/chat/stream_chat.py", line 8, in <module>
    from llmtuner.tuner.core import get_infer_args, load_model_and_tokenizer
  File "/share/home/22351111/lyc_LoRA_Test/src/llmtuner/tuner/__init__.py", line 1, in <module>
    from llmtuner.tuner.tune import export_model, run_exp
  File "/share/home/22351111/lyc_LoRA_Test/src/llmtuner/tuner/tune.py", line 5, in <module>
    from llmtuner.tuner.core import get_train_args, load_model_and_tokenizer
  File "/share/home/22351111/lyc_LoRA_Test/src/llmtuner/tuner/core/__init__.py", line 2, in <module>
    from llmtuner.tuner.core.loader import load_model_and_tokenizer
  File "/share/home/22351111/lyc_LoRA_Test/src/llmtuner/tuner/core/loader.py", line 39, in <module>
    require_version("trl>=0.7.1", "To fix: pip install trl>=0.7.1")
  File "/share/home/22351111/anaconda3/envs/llama_peft4/lib/python3.9/site-packages/transformers/utils/versions.py", line 111, in require_version
    _compare_versions(op, got_ver, want_ver, requirement, pkg, hint)
  File "/share/home/22351111/anaconda3/envs/llama_peft4/lib/python3.9/site-packages/transformers/utils/versions.py", line 44, in _compare_versions
    raise ImportError(
ImportError: trl>=0.7.1 is required for a normal functioning of this module, but found trl==0.4.7.
To fix: pip install trl>=0.7.1
